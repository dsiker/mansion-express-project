<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<img src="<%= @mansion.photo_url %>" height="402px" width="100%"/>


<div id="mansion_show_container">
	<!--Show Leave button if user in mansion, else show Join button if room availble-->
		<% if current_user && in_mansion?(current_user, @mansion) %>
			<div id="joinbutton"><%= link_to 'Leave', destroy_booking_path, class: 'btn-lg btn-danger ' %></div>
	  <%elsif room_available?(@mansion)%>
	  	<div id="joinbutton"><%= link_to 'Apply', new_booking_path, class: 'btn-lg btn-success' %></div>
	  <%end%>



	

	<div id="price2">Total Price Per Night: <%=@mansion.price%>
</div>

<div id="pricings">
	</br> Price Per Person Based on Occupancy:
		<%# prices_per_occupants(@mansion) do |occupant_count, price| %>
			<!--<strong><%#= occupant_count %> People:</strong> $<%#= price %>-->
		<%# %>

		<%x=1%>
		<%until x > @mansion.bedrooms.to_i %>
		<strong><%= x %> People:</strong> $<%= (@mansion.price.scan(/[.0-9]/).join().to_i)/(x) %>
		<%x+=1%>

		<%end%>
	
</br>
</div> 



<div id="left1">
	<h2><strong><%= @mansion.name %></strong></h2>
	<p><%= @mansion.city %>, <%= @mansion.country %>, <%= @mansion.region %></br>
	<%= @mansion.bedrooms %> bedrooms, <%= @mansion.bathrooms %> bathrooms
</p></br>

	<strong>Description: </strong><div id="description"><%= @mansion.description %></div></strong>
</div>



<div id="right1">
	<h2 align="center"> MansionMates </h2>

</br>
	<div id="userimgs">
		<% @users.each do |user| %>
		<%= link_to image_tag(user.photo.url(:join)), user %>
	<% end %>
	</div>
</div>




</div>
<div id="clear"></div>
	<div id='mansionshow'>
    <script>
      var handler = Gmaps.build('Google');
      handler.buildMap({ provider: {}, internal: {id: 'mansionshow'}}, function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
    </script> 		
	</div>
</div>


