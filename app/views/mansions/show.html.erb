<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<div id="mansion_show_img">
	<h1><strong><%= @mansion.name %></strong></h1>
	<img src="<%= @mansion.photo_url %>" height="500px" width="760px" align="center"/>
</div>

<div id="mansion_show_container">
<!--Show Leave button if user in mansion, else show Join button if room availble-->
	<% if current_user && in_mansion?(current_user, @mansion) %>
		<div id="joinbutton"><%= link_to 'Leave', destroy_booking_path, class: 'btn-lg btn-danger ' %></div>
	 <%elsif room_available?(@mansion)%>
	  	<div id="joinbutton"><%= link_to 'Apply', new_booking_path, class: 'btn-lg btn-success' %></div>
	 <%end%>
<!--Pricings -->
	<div id="price2">
		Total Price Per Night: <%=@mansion.price%>
	</div>

	<div id="pricings">
		</br> Price Per Person Based on Occupancy:
		<%= prices_per_occupants(@mansion)%>
	</div> 
<!--Mansion Information -->
	<div id="left1">
		<p><%= @mansion.city %>, <%= @mansion.country %>, <%= @mansion.region %></br>
			 <%= @mansion.bedrooms %> bedrooms, <%= @mansion.bathrooms %> bathrooms</br>
		</p>
		<strong>Description: </strong>
			<div id="description">
				<%= @mansion.description %>
			</div>
	</div>
<!--MansionMates Information-->
	<div id="right1">
		<h2 align="center"> MansionMates </h2></br>
		<div id="userimgs">
			<% @users.each do |user| %>
				<%= link_to image_tag(user.photo.url(:join)), user %>
			<% end %>
		</div>
	</div>

	<div id="clear"></div>
</div>
<!--HERE HERE HERE Maps NOT WORKING -->
<div class='mansionShowMap'>
   <script>
      var handler = Gmaps.build('Google');
      handler.buildMap({ provider: {}, internal: {id: 'mansionshow'}}, function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
   </script> 		
</div>


