<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<img src="<%= @mansion.photo_url %>" height="402px" width="100%"/>

	<% if current_user %>
	<% unless current_user.mansions.include?(@mansion) %>
		<% if @mansion.users.count < @mansion.bedrooms %>
			<div id="joinbutton"><%= link_to 'Join', new_booking_path, class: 'btn-lg btn-success' %></div>
		<% end %>
	<% else %>
		<div id="joinbutton"><%= link_to 'Leave', destroy_booking_path, class: 'btn-lg btn-danger ' %></div>
	<% end %>
<% end %>


	<div id="price2">Total Price Per Night: <%= @mansion.price %>
</div>

<!-- <div class="mansionDescription center-block">	
 -->	<%#= image_tag(@mansion.photo.url(:medium), class: 'mansionShow') %>
	<%#= image_tag(@mansion.photo_url), class: 'mansionShow' %>
<div class="jumbotron">
	<h1><%= @mansion.name %></h1>
	<h3>City: <%= @mansion.city %></h3>
	<h1>Country: <%= @mansion.country %></h1>
	<h1>Region: <%= @mansion.region %></h1>
	<h1>Price: <%= @mansion.price %></h1>
	<h1>Bedrooms: <%= @mansion.bedrooms %></h1>
	<h1>Bathrooms: <%= @mansion.bathrooms %></h1>
</div>

<div id="pricings">
	</br> Price Per Person Based on Occupancy:
		<%x=1%>
		<%until x > @mansion.bedrooms.to_i %>
		<strong><%= x %> People:</strong> $<%= (@mansion.price.scan(/[.0-9]/).join().to_i)/(x) %>
		<%x+=1%>

		<%end%>
	
</br>
</div> 



<div id="left1">
	<h2><strong><%= @mansion.name %></strong></h2>
	<p><%= @mansion.city %>, <%= @mansion.country %>, <%= @mansion.region %></br>
	<%= @mansion.bedrooms %> bedrooms, <%= @mansion.bathrooms %> bathrooms
</p></br>

	<strong>Description: </strong><div id="description"><%= @mansion.description %></div></strong>
</div>

<div id="right1">
	<h2 align="center"> MansionMates </h2>
	<div id="pledgepoints">
	<%if @users %>
	<strong>Pledge Compatibility Points:</strong> <%=overall_pledge_compatibility_points(@users) %>
	  <strong> Pledge Compatibility Percentage:</strong> <%=overall_pledge_compatibility_percentage(@users) %>%
	<%end%>
	</div>
</br>
	<div id="userimgs">
		<% @users.each do |user| %>
		<%= link_to image_tag(user.photo.url(:join)), user %>
	<% end %>
	</div>
 
</div>

<div id="clear"></div>

	<div id='mansionShowMapid' class="mansionShowMap"  style='width: 100%; height: 400px;'>
    <script>
      handler = Gmaps.build('Google');
      handler.buildMap({ provider: {}, internal: {id: 'mansionShowMapid'}}, function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
    </script> 		
	</div>
</div>
