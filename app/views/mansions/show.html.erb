<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<img src="<%= @mansion.photo_url %>" height="402px" width="1280px"/>

	<% if current_user %>
	<% unless current_user.mansions.include?(@mansion) %>
		<% if @mansion.users.count < @mansion.bedrooms %>
			<div id="joinbutton"><%= link_to 'Join', new_booking_path, class: 'btn-lg btn-success' %></div>
		<% end %>
	<% else %>
		<div id="joinbutton"><%= link_to 'Leave', destroy_booking_path, class: 'btn-lg btn-danger ' %></div>
	<% end %>
<% end %>




	<div id="price2">Total Group Price Per Night: <%= @mansion.price %>
	</br>


	</div>



<div id="left1">
	<p><strong><%= @mansion.name %></strong></br>
	<%= @mansion.city %>, <%= @mansion.country %>, <%= @mansion.region %></br>
	<%= @mansion.bedrooms %> bedrooms, <%= @mansion.bathrooms %> bathrooms
</p></br>

	<strong>Description: </strong><div id="description"><%= @mansion.description %></div></strong>
</div>



<div id="right1">

	<div id="pledgepoints">
<%if @users %>
<strong>Pledge Compatibility Points:</strong> <%=overall_pledge_compatibility_points(@users) %>
  <strong> Pledge Compatibility Percentage:</strong> <%=overall_pledge_compatibility_percentage(@users) %>%
<%end%>
</div>

<div id="userimgs">
	<% @users.each do |user| %>
	<%= link_to image_tag(user.photo.url(:join)), user %>
<% end %>
</div>
 

	

</div>





<div id="clear"></div>

	<div id='mansionShowMapid' class="mansionShowMap"  style='width: 100%; height: 400px;'>
    <script>
      handler = Gmaps.build('Google');
      handler.buildMap({ provider: {}, internal: {id: 'mansionShowMapid'}}, function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
    </script> 		
	</div>
</div>
